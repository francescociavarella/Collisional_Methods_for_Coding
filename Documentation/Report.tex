\documentclass[a4paper,11pt]{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{titlesec}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{hyperref}
\usepackage{parskip}
\usepackage{braket}
\usepackage{tikz}
\usepackage{cancel}
\usepackage[top=2cm, bottom=2cm, left=2cm, right=2cm]{geometry}
\usepackage{graphicx}
\usepackage{float}
\usetikzlibrary{arrows.meta, angles, quotes}
\usepackage{xcolor}
\usepackage{listings}

\definecolor{codegray}{rgb}{0.95,0.95,0.95}
\definecolor{codeblue}{rgb}{0,0,0.6}
\definecolor{codegreen}{rgb}{0,0.4,0}

\usepackage{forest}
\usetikzlibrary{shadows, arrows.meta}

\tikzset{
	folder style/.style={
		draw=black!50,
		top color=white, bottom color=gray!10,
		rounded corners, font=\ttfamily\small,
		drop shadow
	}
}

\lstdefinestyle{mystyle}{
	backgroundcolor=\color{codegray},   
	commentstyle=\color{codegreen},
	keywordstyle=\color{codeblue},
	basicstyle=\ttfamily\footnotesize,
	breakatwhitespace=false,         
	breaklines=true,                 
	captionpos=b,                    
	keepspaces=true,                 
	showspaces=false,                
	showstringspaces=false,
	showtabs=false,                  
	tabsize=2,
}

\lstset{style=mystyle}

\allowdisplaybreaks

\titleformat{\section}
{\normalfont\normalsize\bfseries}
{\thesection}{1em}{}
\titleformat{\subsection}
{\normalfont\normalsize\bfseries}
{\thesubsection}{1em}{}
\titleformat{\subsubsection}
{\normalfont\normalsize\bfseries}
{\thesubsubsection}{1em}{}

\title{
	\vspace{2cm}
	\Huge \textbf{Collisional Methods} \\[0.5cm]
	\large Analysis of the Unraveling of Quantum Master Equations in the Quantum Jump and Diffusional Limits
	\vspace{5cm}
}

\author{\Large Francesco Ciavarella - University of Padua \\[10pt] \href{mailto:francesco.ciavarella@studenti.unipd.it}{francesco.ciavarella@studenti.unipd.it}}

\begin{document}
	
	\maketitle
	\thispagestyle{empty} 
	\newpage
	
	\tableofcontents
	\newpage
	
	\section{Introduction}
	\label{sec:intro}
	
	\subsection{Open Quantum System an Quantum Master Equation}
	\label{sub:open_quantum_sys_QME}
	First, it is essential to frame the scope of this project within the field of \textit{Environment-Assisted Quantum Transport (ENAQT)}. This framework focuses on evaluating the effects of the surrounding environment on open quantum systems. The latter are usually constituted of a set of qubits representing different chromophores' energy states.
	Such systems are typically described using the \textit{density matrix} formalism, where we define $ \rho_S = \sum_{k}^{N}{\ket{\Psi_{k}^{S}}\bra{\Psi_{k}^{S}}} $.\\
	This approach is fundamental as it allows for the treatment of quantum systems subject to classical statistical uncertainty (i.e. mixed states), combining quantum coherent superposition with classical probabilities.

	Specifically, ENAQT explores how environment-induced phenomena can enhance the efficiency of excitonic transport across different sites (i.e., the transfer of excitation). In this context, one of the simplest environmental effects is the induction of \textit{Decoherence}: a mechanism that facilitates the transfer of excitation toward the final target site by destroying the coherence between different sites and localizing the excitation in a single one.

	In the study of open quantum systems, various equations can describe the dynamics of these sites, defined as the evolution of the system's density matrix over time.	

	To account for environmental effects, it would formally be necessary to study the evolution of the \textit{total system}, i.e. comprising both the sites and the environment's degrees of freedom, and subsequently perform a \textit{partial trace} over the latter. However, since the dimensionality of this total Hilbert space is often computationally unmanageable, the standard approach involves the use of \textit{Dynamical Maps}. These maps allow us to obtain the evolution of the system alone while still accounting for the effect of the external environment, such as \textit{Dephasing} or \textit{Relaxation}.

	Among the most well-known \textit{Dynamical Maps} there are the \textit{Redfield equation}, which is microscopically derived, and the \textit{Lindblad equation}. The latter is based on the theory of quantum semigroups and is derived with a more mathematical approach to ensure the evolution remains \textit{Completely Positive and Trace Preserving} (CPTP) at all times. In this work, we will specifically focus on the Lindblad master equation, which reads : 
	
	\begin{equation}
		\dot{\rho_{S}} = -i [\hat{H}, \rho_{S}] + \sum_j \gamma_j \left( \hat{L}_j \rho_{S} {\hat{L}_j}^\dagger - \frac{1}{2} \left[ \hat{L}_j^\dagger \hat{L}_j, \rho_{S} \right]_{+} \right) = \hat{\mathcal{L}} \rho_{S}
		\label{eq:lindblad}
	\end{equation}

	where $ \gamma_j $ are the \textit{Lindblad rates}, that may be different for every sites; while $ \hat{L}_j $ are the \textit{Jump operator}, which describe the environment effect on the system; eventually $ \hat{\mathcal{L}} $ represents the \textit{Liouvillian Super Operator}.
		
	In this specific study, we will focus exclusively on the phenomenon of \textit{pure Dephasing}. This process is responsible for the suppression of quantum coherences between different sites, favoring excitonic transport. 
	For our model, this mechanism is described by the jump operators 
	\begin{equation}
		\hat{L}_j = \sigma_z^{(k)}
		\label{eq:jump_operator_z}
	\end{equation}
	where $\sigma_z$ is the Pauli matrices acting on the $k$-th site (represented by a qubit). This choice of operator ensures that while the off-diagonal elements of the density matrix (the coherences) decay over time, the diagonal elements (the populations) remain unaffected.
	
	\newpage
	
	\subsection{Stochastic Unraveling of Quantum Master Equation}
	\label{sub:unraveling}
	
	The concept of \textit{unraveling} refers to the decomposition of the deterministic Master Equation into a statistical ensemble of single stochastic trajectories. Instead of directly evolving the density matrix $ \rho_{S} $, which describes the average state of the ensemble, one evolves a single wave function $ \ket{\psi(t)} $ subject to random events, which represents the direct effect of the environment on the quantum state. The full dynamics of the density matrix is then reconstructed by averaging over a large number of these realizations:
	\begin{equation}
		\rho_{S}(t) \approx \frac{1}{M} \sum_{j=1}^M \ket{\psi_{j}^{S}(t)}\bra{\psi_{j}^{S}(t)}
		\label{eq:mean_over_traj}
	\end{equation}
	where $M$ is the number of simulated trajectories.

	This approach offers different advantages such as the reduction of the computational cost, since with if $N$ is the dimension of the Hilbert space, the density matrix $\rho$ involves $N^2$ elements and it's evolution scales as $O(N^2)$, instead of the wave function, that contains only $N$ components and scales as $O(N)$. \\
	Another advantage is that the Master Equation describes only the average effect of the environment on the System Density Matrix, while in the stochastic unraveling, analyzing a single realization, it's possible to understand how effectively the environment affects the system, distinguishing between the fundamental quantum uncertainty and the statistical mixture resulting from decoherence.
	
	In this sense it's possible to define two opposite limits, describing the  environment effect on the system, which are the so called :
	
	\begin{itemize}
		\item \textbf{Diffusive Limit:} The environment induces small changes in the system's state but acts continuously in time, behaving as a source of random noise. This regime is physically associated with a \textit{weak measurement} performed on the system.
		
		\item \textbf{Quantum Jump Limit:} The environment induces a strong, discontinuous modification of the system's wave function, but the probability of this event occurring is very low in a single time step. In contrast to the diffusive case, this limit corresponds to a \textit{strong measurement} performed on the system.
	\end{itemize}
	
	\subsection{Collisional Method}
	\label{sub:CM}
	While there are several established algorithms for unraveling the Quantum Master Equationâ€”such as the \textit{Stochastic Schr\"odinger Equation} (SSE) or the \textit{Monte Carlo Wave Function} (MCWF) method, this work focuses on the \textit{Collisional Model} framework.
	
	The primary objective is to implement and explore this approach, which reconstructs the continuous dynamics through a sequence of discrete interactions, called \textit{Collisions}, occurring over a finite time step $\Delta t$.
	In this model, the environment is not treated as a continuum but is represented by a set of auxiliary units called \textit{Ancillas}, typically modeled as qubits (two-level systems).
	
	The dynamics proceeds as follows:
	\begin{enumerate}
		\item \textbf{Initialization:} At the beginning of each step, the System and the current Ancilla are in a \textit{product state}, $\rho_{tot} = \rho_S \otimes \rho_A$.
		\item \textbf{Collision:} They undergo a joint unitary evolution governed by a specific \textit{Collisional Hamiltonian}, which generally creates entanglement between the System and the Ancilla.
		\item \textbf{Measurement:} A measurement is performed on the Ancilla. Due to the quantum correlations established during the collision, the outcome of this measurement induces a conditional change on the System's state.
		\item \textbf{Reset:} After the measurement, the current ancilla is discarded. For the next time step, the system interacts with a new, identical ancilla initialized in the same initial state, and the cycle repeats. This ensures the Markovian nature of the dynamics. 
	\end{enumerate}
	
	Since the probability of measuring one of the two Ancilla's states is finite, it is possible to implement a \textit{Stochastic Algorithm} which randomly chooses the change to apply to the System, according to the Ancilla's measurement outcome. In this way, it is possible to obtain a single \textit{Random Trajectory}.

	But first of all, focus on the Collisional Methods Hamiltonian form, which in general is divided in two term :
	\begin{equation}
		\mathcal{H}_{CM} = \mathcal{H}_{Exc} + \mathcal{H}_{Collision}
		\label{eq:CM_hamiltonian}
	\end{equation}
	where 
	\begin{equation}
		\mathcal{H}_{Exc} = \mathcal{H}_{Site} + V_{Hopping} = \sum_{j=1}^{N} {\frac{\varepsilon_j}{2} \sigma_{z}^{j} \otimes \mathbb{I}^{\otimes N} } + \sum_{\langle j,j' \rangle} {\frac{V_{j,j'}}{2} \left( \sigma_{x}^{j}\sigma_{x}^{j'} \otimes \mathbb{I}^{\otimes N} + \sigma_{y}^{j}\sigma_{y}^{j'} \otimes \mathbb{I}^{\otimes N} \right)}
		\label{eq:Exc_Hamiltonian} 
	\end{equation}  represents the \textit{Isolated System Hamiltonian},representing the internal dynamics of the $N$ sites.The Hopping term specifically is what allows the effective Exciton transfer, since the Collisonal term just facilitates the transport by canceling the coherence created. The summation on \textit{j} runs over the different System's sites and the  $ \sigma_{\alpha}^j $ term are defined as :
	\begin{equation}
		 \sigma_{\alpha}^j  = \mathbb{I}^{\otimes j-1} \otimes \sigma_{\alpha} \otimes \mathbb{I}^{\otimes N-j}
		 \label{eq:sigma_op_definition}
	\end{equation}
	
	The form of $ \mathcal{H}_{Collision} $ specifically defines the unraveling regime. In order to recover the correct QME form, it's fundamental to correctly initialize the Ancilla's state, which is deeply related to the specific form of \textit{Interaction Hamiltonian}, $ \mathcal{H}_{Collision} $. \\	
	In this context it's possible to associate the two opposite regime, seen before, with two different configurations of the Collisional Method ( i.e. form of the Collisional Hamiltonian and Ancilla's state initialization ): 
	
	\begin{description}
		\item[Diffusive Limit]
		\begin{equation}
			\mathcal{H}_{Coll} = \sum_{j=1}^{N}{c_j \sigma_{z}^{j} \otimes \sigma_{z}^{a_j}} \text{\quad and \quad} \rho_{A} = \frac{1}{2} \begin{pmatrix} 1 & 0 \\ 0 & 1 \end{pmatrix}
			\label{eq:diff_initialization}
		\end{equation}
		The Ancilla is in the complete mixed state, i.e. given a reservoir of Ancillas, there's the 0.5 probability of finding it in the $ \ket{0_a} $ state and so the same for $ \ket{1_a} $ state; in this case  the $ \mathcal{H}_{Coll} $ acts on the Ancilla as a $ \sigma_{z}^{a_j} $, introducing a phase shift on the sate.
		\item[Quantum Jump Limit] 
			\begin{equation}
				\mathcal{H}_{Coll} = \sum_{j=1}^{N}{c_j \sigma_{z}^{j} \otimes \sigma_{x}^{a_j}} \text{\quad and \quad} \rho_{A} = \begin{pmatrix} 1 & 0 \\ 0 & 0 \end{pmatrix}
				\label{eq:QJ_initialization}
			\end{equation}
			The Ancilla is always initialized in the $ \ket{0_a} $ state and the $ \mathcal{H}_{Coll} $ acts on it as a $ \sigma_{x}^{a_j} $ flipping its state.
	\end{description}
	In both cases $ c_j $ represents the \textit{Collision Intensity} for every \textit{j-th} site, a constant related to the \textit{Lindblad Rates} $ \gamma_j $ by the equation:
	\begin{equation}
		c_j = \sqrt{\gamma_j / 4\Delta t}
		\label{eq:c_j_definition} 
	\end{equation}
	
	
	Once we've defined the $ \mathcal{H}_{Collision} $, it's important to see how it affect the System's evolution. In general the wave function at a time step $ t + \Delta t $ is given by the resolution of the Schr\"odinger Equation, which is :
	\begin{equation}
		\ket{\Psi_S (t + \Delta t)} = \mathcal{U} \ket{\Psi_S (t)} = e^{\left(-i \, \mathcal{H}_{CM} \Delta t\right)}\ket{\Psi_S (t)} = e^{\left(-i \, \mathcal{H}_{Exc} \Delta t\right)} e^{\left(-i \, \mathcal{H}_{Coll} \Delta t\right)}\ket{\Psi_S (t)} 
		\label{eq:wf_evolution}
	\end{equation}
	where the last equivalence is valid thanks to a \textit{Trotter-Suzuki} decomposition and allows to separate the evolution in two step:
	\begin{enumerate}
		\item Isolated evolution via $ \mathcal{H}_{Exc} $
		\item Collisional evolution via $ \mathcal{H}_{Coll} $
	\end{enumerate}
	Focusing on the collisional evolution we can analytically define the Evolution Operator \textit{U} form and how it modifies the System \textit{wf}, in the two different limits. Note that in this derivation we will refer to only one site of the System's Hilbert space:

	\begin{description}
		\item[Diffusive Limit] 
		\begin{equation}
			U_{collsion} = \exp \left(-i c_j \sigma_{z}^{j} \otimes \sigma_{z}^{a_j} \Delta t\right) = \cos \left(c_j \Delta t \right) \mathbb{I}^j \otimes \mathbb{I}^a - i \sin \left(c_j \Delta t \right) \sigma_{z}^{j} \otimes \sigma_{z}^{a_j}
			\label{eq:U_coll_Diff}
		\end{equation}
		In this case, since we have to deal with a completely mixed Ancilla's Density Matrix we divide the evolution in two different results based on the Ancilla's state, including in this sense the Classical uncertainty, which is $0.5$ for both the states:
		\begin{align}
			\ket{\Psi_0 (t + \Delta t) } = \Big[ \cos \left(c_j \Delta t \right) - i \sin \left(c_j \Delta t \right) \sigma_{z}^{j} \Big] \ket{\Psi_S(t)} \otimes \ket{0_a}
			\label{eq:psi_evol_Diff0} \\
			\ket{\Psi_1 (t + \Delta t) } = \Big[ \cos \left(c_j \Delta t \right) + i \sin \left(c_j \Delta t \right) \sigma_{z}^{j} \Big] \ket{\Psi_S(t)} \otimes \ket{1_a} 
			\label{eq:psi_evol_Diff1}
		\end{align}
		Depending on the ancilla's state, the system undergoes a rotation in the opposite direction in the Hilbert space; specifically, if the ancilla is in $ \ket{0_a} $ the phase shift is $ + c_j \Delta t \sigma_{z}^{j} $, whereas with $ \ket{1_a} $ the phase shift is $ - c_j \Delta t \sigma_{z}^{j} $. This stochastic alternation between opposite phase shifts results in a quantum random walk of the system's phase. In the limit $ \Delta t \rightarrow 0 $, this discrete process converges to a continuous Brownian motion (Wiener process). Since $ \Delta t \rightarrow 0 $ the effect on the system will be very small.
		\item[Quantum Jump Limit] 
			\begin{equation}
				U_{collsion} = \exp \left(-i c_j \sigma_{z}^{j} \otimes \sigma_{x}^{a_j} \Delta t\right) = \cos \left(c_j \Delta t \right) \mathbb{I}^j \otimes \mathbb{I}^a - i \sin \left(c_j \Delta t \right) \sigma_{z}^{j} \otimes \sigma_{x}^{a_j}
				\label{eq:U_coll_QJ}
			\end{equation}
			\begin{equation}
				\ket{\Psi (t + \Delta t) } = \cos \left(c_j \Delta t \right) \ket{\Psi_S (t)} \otimes \ket{0_a} - i \sin \left(c_j \Delta t \right) \sigma_{z}^{j} \ket{\Psi_S(t)} \otimes \ket{1_a}
				\label{eq:psi_evol_QJ}
			\end{equation}
			In this case we have a modification on the System \textit{wf} only when we measure $ \ket{1_a} $, but the variation isn't premultiplied by a small factor so the change will be significant. On the other hand the probability of measuring $ \ket{1_a} $ is given by
			\begin{equation}
				P_{1_a} = Tr_S \Big[\braket{1_a | \Psi(t + \Delta t)}\braket{\Psi(t + \Delta t) | 1_a}\Big] = \sin^{2}{\left(c_j \Delta t\right)}
				\label{eq:ancilla_probability}
			\end{equation} 
			So in this case we have a significant variation but that happens very rarely.
	\end{description}  
	For more information about the equation derivation please see the \href{run:./Demonstration.pdf}{Demonstration file}, in particular section 1.1 and 2.1. Moreover all the form of $ \ket{\Psi (t + \Delta t) } $ can be lead back to a Lindblad evolution, as specified in section 1.3 and 2.3
	
	\subsection{Theoretical Algorithm}
	\label{sub:theoretical_algorithm}
	Concatenating the evolution given by Eq.\eqref{eq:psi_evol_Diff0} and Eq.\eqref{eq:psi_evol_Diff1} or Eq.\eqref{eq:psi_evol_QJ}, it's possible to create a Stochastic Algorithm that creates a Trajectory in the two limits; averaging then different trajectories realizations it's possible to recover the Lindblad evolution.
	
	\begin{description}
		\item[Quantum Jump Algorithm] \leavevmode
			\begin{enumerate} 
				\item Isolated System's evolution with $ \mathcal{U}_{Exc} = \exp{\left( -i \, \mathcal{H}_{Exc} \Delta t \right) }$
				\item Extraction for every different site of a Random Number $\alpha$ in $[0,1]$
				\item If $ \alpha < \sin^{2}{\left(c_j \Delta t\right)} $ it means that there's been an effective collision that has flipped the initial Ancilla's state $ \ket{0_a} $ to $ \ket{1_a} $ and so the System's \textit{wf} gets modified by $ \sigma_{z}^{j} $ on every \textit{j-th} site; \\
				if $ \alpha > \sin^{2}{\left(c_j \Delta t\right)} $ the system remain unchanged (i.e. application of $ \mathbb{I}^j $ )
				\item Once all the sites have been processed , measure and store System's Observables at that time step (like population)
				\item Repeat the algorithm for the next time step
			\end{enumerate}
		\item[Diffusive Algorithm] \leavevmode
			\begin{enumerate} 
				\item Isolated System's evolution with $ \mathcal{U}_{Exc} = \exp{\left( -i \, \mathcal{H}_{Exc} \Delta t \right) }$
				\item Extraction for every different site of a Random Number 	$\alpha$ in $[0,1]$
				\item If $ \alpha < 0.5 $ it means that state $ \ket{0_a} $ has been measured and so the System's \textit{wf} gets modified via EQ.\eqref{eq:psi_evol_Diff0} for every \textit{j-th} site;
				otherwise state $ \ket{1_a} $ has been measured and the System's \textit{wf} gets modified via EQ.\eqref{eq:psi_evol_Diff1}.
				\item Once all the sites have been processed , measure and store System's Observables at that time step (like population)
				\item Repeat the algorithm for the next time step
			\end{enumerate}
		\end{description}
		
		Since the update operators in both limits are unitary, the wave function norm is theoretically preserved at each step. However, to prevent numerical errors from accumulating over long simulations, it is standard practice to enforce renormalization after every time step.
		
	\subsection{Complete Evolution and Ancilla Trace}
	\label{sub:complete_evolution}
	While the stochastic unraveling focuses on individual trajectories of the \textit{wf}, the \textit{Collisional Mode}l can also be formulated deterministically for the complete Density Matrix $ \rho_S \otimes \rho_A $. \\
	The evolution of the system's Density Matrix $\rho_S$ over a time step is obtained by evolving the total state and then performing a \textit{partial trace} over the Ancilla's degrees of freedom. This operation mathematically corresponds to averaging over all possible measurement outcomes of the ancilla. \\
	In this way we are creating a so called \textit{Dynamical Map} $ \Phi $, which reads:
	
	\begin{equation}
		\rho_S(t + \delta t) = \Phi[\rho_S(t)] = \text{Tr}_A \left[ \mathcal{U} \left( \rho_S(t) \otimes \rho_A \right) \mathcal{U} ^\dagger \right]
		\label{eq:dynamical_map}
	\end{equation}
	Since $\mathcal{U}$ is unitary, this map is guaranteed to be Completely Positive and Trace Preserving (CPTP).\\
	It can be shown that in the continuous limit, i.e $ \Delta t \rightarrow 0 $ the discrete map defined in Eq.\eqref{eq:dynamical_map} converges to the differential Lindblad Master Equation (see section 1.3 in \href{run:./Demonstration.pdf}{Demonstration file}). \\
	Thus, the Collisional Model serves as a rigorous microscopic derivation of the Lindblad dynamics.
	 	
	\section{Case Study : Exciton Dimer}
	\label{sec:exciton_dimer}
	Since this work is a preliminary study of \textit{Collisional Methods}, the system consider is one of the simplest relevant to quantum transport: the \textit{Exciton Dimer}. This system consists of two sites, where each site is modeled as a two-level system (qubit). The computational basis for the composite Hilbert space is given by: 
	\begin{equation}
		\left\{\ket{00}, \ket{01}, \ket{10}, \ket{11} \right\}
	\end{equation}
	where the notation $\ket{s_1 s_2}$ represents the tensor product $\ket{s}_1 \otimes \ket{s}_2$, with $0$ denoting the ground state and $1$ the excited state. \\
	Since the objective is to study the exciton transport between sites, the initial state is define as one site completely in excited state and the other in ground state. The interaction between the two sites is defined by the Hopping Potential \textit{v}, built to allow only exchange between the two excited states, conserving the total number of excitations. In this way
	the dynamics is restricted to the \textit{single-excitation manifold} and  allows us to effectively reduce the four-dimensional Hilbert space to a two-dimensional subspace, that can be represented by a single qubit built on the excited states $ \left\{ \ket{01}, \ket{10} \right\} $.
	As already said, the effect induced by the environment is just the \textit{Pure Dephasing}, which essentially destroys the coherence between the two states, facilitating the localization of the exciton.  
	
	The key observables analyzed during the time evolution are the Excited States Populations, representing the probability of finding the Excitation in site 1 or 2. Furthermore it's possible to reconstruct the the state vector in the \textit{Bloch Sphere}, which could help visualizing the evolution in time. 
	
	The results obtained with the \textit{Collisional Method}, both the Stochastic Trajectories and the Average Dynamics of the $ \rho_S $ (obtained tracing out the Ancilla), will be compared with the Lindblad Master Equation and the Isolated System Dynamics.
	
	
	\section{Computational Implementation}
	\label{sec:comp_implemnt}
	Once the theoretical background is defined, we now focus on the computational implementation. \\
	The objective is the \textit{Numerically} generation of \textit{Stochastic Trajectories} that will be benchmarked as described above. This task is performed by the \texttt{Main\_Dynamics.py} program, where the mathematical formalism of \textit{Collisional Method} is translate into a time-discrete simulation, reproducing the iterative interaction between the System and the Ancilla reservoir, in the \textit{Quantum Jump} and \textit{Diffusive Limit}. \\
	For the Results visualization two dedicated Jupyter Notebooks were developed:
	\begin{enumerate}
		\item \texttt{Plot.ipynb} : based on the Python library \texttt{Matplotlib}, this program gives some examples of the 2D plot that can be made with the dynamics results; the \textit{\%matplotlib ipympl} command enable interactive data exploration directly within the notebook interface.
		\item \texttt{Bloch\_Sphere.ipynb} : based on the visualization tools of the Python library \texttt{Qutip}, this program generates an animated GIF representing the dynamics on the State Vector on the Bloch Sphere, providing a 3D representation of the dynamics.
	\end{enumerate}
	
	
	\subsection{Language Choice and Libraries}
	\label{sub:langauge_libraries}
	The simulation is implemented in \textit{Python}, chosen for its object-oriented features to treat mathematical entities such as wave functions and operators as high-level objects. In this regard, two fundamental libraries are used:
	\begin{itemize}
		\item \texttt{Numpy} : used for linear algebra operations, allows direct representation of quantum states as vectors, Hamiltonians as matrices and provides tools for optimized operations such as matrix multiplication.
		\item \texttt{Qutip}(\textit{Quantum Toolbox in Python}) : employed for specific quantum mechanical operations that require structural knowledge of the Hilbert space; this library provides complete Master Equation solver too.
	\end{itemize}
	Going into more detail, \texttt{Numpy} works with dense matrices and is made for generic linear algebra operation; instead \texttt{Qutip} works with \texttt{Qobj} (Quantum Object), that are sparse matrices with additional metadata describing the physical state (es bra, ket ...) and the associated Hilbert space. 
	
	For completeness, also the \texttt{Scipy} library is used, in particular its \texttt{Scipy.linalg} module, dedicated to linear algebra, from which it's imported the \texttt{expm} function, that allows to numerically build up the Evolution in time operator $\mathcal{U}$ as matrix exponential of the Hamiltonian. 
	
	While the algorithmic logic follows a procedural paradigm, this high-level approach allows the code to remain readable and close to the mathematical formulation.
	
	\paragraph{Technical note :} since \texttt{Qobj} and \texttt{Np array} are incompatible, it's often used the following control line that converts a \texttt{Qobj} in a \texttt{Np array}, since the core calculations rely on \texttt{Numpy}
	
	\begin{lstlisting}[language=Python]
		# Convert a generic variable 'var' to a dense array if it is a Qobj
		var = var.full() if hasattr(var, "full") else np.array(var, dtype=complex)
		# or a List element by element
		List = [L_element.full() if hasattr(L_element, "full") else np.array(L_element, dtype=complex) for L_element in List]
	\end{lstlisting}
	This control line checks if an object has the \texttt{.full()} method (typical of QuTiP objects) and extracts the dense matrix; otherwise, it treats the object as a standard array.
	
	\newpage
	
	\subsection{Structure of the \texttt{Main\_Dynamic.py} Script}
	\label{sub:main_dynamics_structure}	
	The \texttt{main\_dynamic} script represents the core of the computational implementation. Beyond the computation of Evolution Trajectories, this code explored the \textbf{Convergence Limit} of the model, by testing different $ \Delta t $ values and Number of Trajectories $ N_{Traj} $ to average over. With this approach the main loop is run multiple times with different value of the two parameters, in order to eventually compare the results. The variation of $\Delta t$ necessitates a dynamic update of the physical parameters: specifically, the interaction coefficients $ c_j = \sqrt{\gamma_j / 4\Delta t} $ valuesare recalculated at each $ \Delta t $ variation. \\
	The program is organized into distinct logical blocks, each dedicated to a specific task; this section is dedicated to the description and explanation of the algorithmic choices and the data structures of each section.
	
	\subsubsection{System Definition and Evolution Operators}
	\label{subsub:Hamiltonians_U}
	The first section is dedicated to the Hamiltonians construction and the definition of the Evolution Operator $ \mathcal{U}(\Delta t) $.
	The first is modularized into dedicated functions:
	\begin{enumerate}
		\item \texttt{system\_Hamiltonian} : constructs the System's Hamiltonian matrix based on Eq.\eqref{eq:Exc_Hamiltonian} with the input parameters, defined in the \texttt{Parameters} section: \texttt{N\_site} (number of sites), \texttt{E} (array of site energies, \textit{randomly generated}) and \texttt{V\_pot}, array that contains the coupling constants for every unique pair of sites $(i, j)$ with $i < j$, organized as 
		\begin{equation*}
			V_{pot} = [V_{12}, V_{13}, \dots, V_{1N_{site}}, V_{23}, \dots, V_{N_{site}-1,N_{site}}]
			\label{potential_definition}
		\end{equation*}
		in the Exciton Dimer $ N_{site} = 2 $ case this reduces to a single element array $ V_{pot} = [V_{12}] $. \\
		It's important noting that this definition of $ V_{pot} $ defines an \textit{all-to-all connectivity} and may be transform in a "Nearest-Neighbor Interaction" modulating the single value. \\
		Giving this input the function returns a Numpy matrix representing the System Hamiltonian.
		\item \texttt{interaction\_Hamiltonian\_N\_ancillas}: constructs the Interaction Hamiltonian both in the \textit{Diffusive Limit} Eq.\eqref{eq:diff_initialization} and in the \textit{Quantum Jump Limit} Eq.\eqref{eq:QJ_initialization}; the input required are \texttt{N\_site} and \texttt{c\_CM} (constant Collisional Methods), which is an array containing the value of $ c_j $ defined in Eq.\eqref{eq:c_j_definition} for every site.
		\item \texttt{hamiltonian\_N\_ancillas} : constructs the Complete Hamiltonian, firstly expanding the System Hamiltonian in the complete Hilbert Space (i.e. System + Ancilla) and then summing it to the Interaction Hamiltonian (already construct in the total space) 
	\end{enumerate}
	It's important to focus on how formally an Hamiltonian operating on different sites is constructed : following the formal definition given in Eq.\eqref{eq:sigma_op_definition}, i.e. any local operator acting on the $j$-th site can be expressed as a tensor product of the operator on the target site and identity matrices on all others. This can be computationally achieved by initializing a list of $ 2\times2 \, \mathbb{I} $, representing the complete space, and replacing in the \textit{j-th} position the operator acting on the \textit{j-th} site. Finally the tensor product of the list elements is computed using the \texttt{QuTip} function \texttt{tensor}. In the case of $ \mathcal{H}_{Coll} $ the composite System has dimension $ 2^{2N_{site}} $ and two operators are placed simultaneously: $\sigma_z$ on the $j$-th system site and the corresponding ancilla operator on the \textit{(N+j)-th} site as reported in the following example:
	\begin{lstlisting}[language=Python]
		# Construction of Collisional Hamiltonian 
		for j in range(N_site):
			op_list = [identity(2) for _ in range(2 * N_site)]  #list of identity 
			op_list[j] = sigmaz()      # Acts on the j site
			op_list[N_site + j] = anc_op  # Acts on the j ancilla, with index N + j
			H_term = (c_CM[j] * tensor(op_list)).full() # tensor product for list's element
			H_int += H_term
	\end{lstlisting}
	
	\newpage
	
	The Evolution Operator $ \mathcal{U} = \exp{\left(-i \mathcal{H} \Delta t \right)} $ is computationally constructed in two different ways:
	\begin{itemize}
		\item with the \texttt{Scipy.linalg} function \texttt{expm}
		\item Diagonalizing the $ \mathcal{H} $ matrix with the \texttt{Numpy.linalg} function \texttt{Numpy.linalg.eigh}, using the \textit{Eigenvalues w} to build a diagonal matrix with element $ \mathcal{U}_{diag} = \exp{\left(-i w \Delta t \right)} $ and finally, using the \textit{Eigenvectors V}, moving back to the original basis $ \mathcal{U} = V \, \mathcal{U}_{diag} V^{\dagger} $.
	\end{itemize} 
		 
	\subsubsection{Lindblad Evolution}
	\label{subsub:lindblad_evo}
	In this section the benchmark evolution via \textit{Lindblad Master Equation} is calculated. The \textit{Jump Operators} $ L_j $ and the \textit{Lindblad rates} $ \gamma_j $ are defined in the \texttt{Parameters} section.\\
	First the \textit{Liouvillian Superoperator} is computationally construct with the \texttt{Liouvillian} function. The effective time evolution, related to Eq.\eqref{eq:lindblad}, is implemented by the \texttt{Lindblad\_evo} function. In this approach the Lindblad ME is solved in the \textit{Liouvillian Space}, where the System's Density Matrix is vectorized and allowing the Liouvillian to be represented as a square matrix. This formulation enables the construction of the Time Evolution Operator $ \mathcal{U} $ via either the \texttt{expm} method or diagonalization, as described previously. Once the $ \mathcal{U} $ has been defined and applied the resulting update vectorized state $ \rho_{S} (t + \Delta t) $ is stored in \texttt{rho\_vec\_list}, a list containing the resulting $ \rho_{S} $ at every time step. Finally this list is returned in vectorized form or reshaped in standard Density Matrices.
	
	\subsubsection{Isolated System Evolution}
	\label{subsub:isolated_evo}
	The second benchmark dynamics is the one obtained without the \textit{Collisional Hamiltonian}, i.e. governed only by $ \mathcal{H}_{Exc} $. The trajectory can be easily obtained evolving the System wave function with the Unitary Time Evolution Operator $ \mathcal{U} = \exp{\left(-i \, \mathcal{H}_{Exc} \Delta t \right)} $. To optimize memory usage, the complete \textit{wf} is not stored at every step; instead the site's Population are computed and stored at every time step in \texttt{pop\_traj\_isolated}, a 2D array with dimensions $ [N_{Site},  N_{t\, Steps}] $. To extract this observables it's used the \texttt{projectors} list, which contains projectors operators on the excited states in matrix form.
	
	For the specific case of the Exciton Dimer, the expected physical behavior is a coherent, continuous oscillation of the population between the two sites (Rabi oscillations).
	
	\subsubsection{Trace on Ancilla Evolution}
	\label{subsub:trace_anc_evo}
	The first dynamics simulated using \textit{Collisional Methods} is the one based on the deterministic evolution of $ \rho_{S} \otimes \rho_A $ with 
	\begin{equation}
		\mathcal{U}_{CM} = \exp{\left(-i \, \mathcal{H}_{CM}\Delta t\right)} = \exp{\left(-i \, \left(\mathcal{H}_{Exc} + \mathcal{H}_{Coll}\right) \Delta t \right) } 
	\end{equation} 
	At each step, the Ancilla's degrees of freedom are traced out, as described in Section \ref{sub:complete_evolution}. \\
	This process is implemented in the \texttt{compute\_trace\_ancilla} function. After constructing the Ancilla's Density Matrix, either in the \textit{Quantum Jump} or \textit{Diffusive Limit}, and the $ \mathcal{U}_{CM} $ operator, the function follows this algorithm to compute the evolution for every timestep:
	\begin{enumerate}
		\item Expansion in the System-Ancilla composite Hilbert space by tensor product between $ \rho = \rho_{S} \otimes \rho_A $
		\item Unitary Evolution of the total Density Matrix : $ \rho(t + \Delta t) =  \mathcal{U}_{CM}(\Delta t) \, \rho (t) \, \mathcal{U}_{CM}^{\dagger}(\Delta t) $
		\item \textit{Partial Trace} over the Ancilla's degree of freedom
		\item Using the \texttt{projectors} list, calculation and storage of every site's Population in \texttt{pops\_complete}, a 2D array with dimensions $ [N_{Site},  N_{t\, Steps}] $
	\end{enumerate}
	Focusing on the \textit{Partial Trace} operation, it's computed using two important \texttt{Numpy} functions:
	\begin{lstlisting}[language=python]
		# 3 : Partial Trace on the ancilla's degree of freedom
		rho_tot_reshaped = rho_tot.reshape(dim_sys, dim_anc, dim_sys, dim_anc) 
		rho_sys = np.trace(rho_tot_reshaped, axis1=1, axis2=3) 
	\end{lstlisting}
	The first line reshapes the 2D density matrix into a \textit{Block Matrix} with $ N_{Site} \times N_{Site} $ blocks and indices $(i_S, \alpha_A, j_S, \beta_A)$. This structure explicitly separates the System and Ancilla indices.\\
	The second line computes the trace contraction over the Ancilla indices (axis 1 and 3), effectively summing the diagonal elements of the Ancilla subspace for every System configuration. This translates mathematically into:
	 \begin{equation}
	 	\rho_{S_{i_S,j_S}} = \text{Tr}_A \left[\rho\right] = \sum_{\alpha_A=\beta_A}{\rho_{Tens}\left[i_S, \alpha_A, j_S, \beta_A\right]}
	 \end{equation}
	 	
	\paragraph{Remark :} Note that in this case the\textit{Trotter-Suzuki approximation} on the Time Evolution Operator is \textbf{not} applied, i.e. it is construct with the total $\mathcal{H}_{CM}$ in Eq.\eqref{eq:CM_hamiltonian}. With this approach the trajectory obtained is exact (except for the time discretization error) and not affected by the error introduced by the \textit{Trotter-Suzuki approximation} : $ \mathcal{O}(\Delta t^2 / m^2) $ at first order.
	
	\subsubsection{Stochastic Trajectory}
	\label{sub:stochastic_trajectory}
	This section is dedicated to the computation of the \textit{Stochastic Trajectory} generated by the \textit{Collisional Methods}. 
	Before dealing with the algorithm, it's fundamental to define define the quantities calculated by the algorithm and their storage structure:
	\begin{itemize}
		\item \texttt{pop\_traj} : 3D array with dimension $ [N_{Site}, N_{t\, Steps}, N_{Trajectories}] $; stores the population of each site at every time step for each independent trajectory.
		\item \texttt{avg\_pop\_traj} : 2D array with dimension $ [N_{Site}, N_{t\, Steps}] $; stores the average value over different trajectories of each site's Population at every time step.
		\item \texttt{r\_x, r\_y, r\_z} : 2D arrays with dimension $ [N_{t\, Steps}, N_{Trajectories}] $; store the Components of the \textit{Bloch State Vector} projected onto the subspace of the Single-Exciton states and computed via the \texttt{compute\_Bloch\_Sphere} function, valid specifically for the Exciton Dimer case.
		\item \texttt{avg\_r\_x, avg\_r\_y, avg\_r\_z} : 1D arrays with dimension $ [N_{t\, Steps}] $; stores average value over different trajectories of the \textit{Bloch State Vector} components.
		\item \texttt{count} : 1D array with dimension $ [N_{Trajectories}] $; stores the cumulative number of measurement of $ \ket{1_a} $ that occurred during the entire trajectory, for each trajectory.
		\item \texttt{avg\_count} : float, represents the average value of count calculated over all $ N_{Traj} $ Trajectories.
	\end{itemize}
	The Evolution Algorithm relies on the logic described in Section \ref{sub:theoretical_algorithm}. The simulation allows switching between the \textit{Quantum Jump} and \textit{Diffusive Limit} by simply modifying the \texttt{method} parameter.\\
	These two regimes differ in:
	\begin{itemize}
		\item the Probability of measuring the state $ \ket{1_a} $
		\item the Evolution applied to the state's \textit{wf}
	\end{itemize}
	The steps of the Algorithm for a Single Trajectory are:
	\begin{enumerate}
		\item Evolution of the complete \textit{wf} with only Site's Evolution Operator $ \mathcal{U}_{Exc}(\Delta t) = \exp{\left(-i \, \mathcal{H}_{Exc} \Delta t \right)} $
		\item Extraction of a Random Number $ \alpha $ in $ [0,1] $ for each System's site
		\item If $ \alpha < $ \textit{probability condition} defined by the dynamics limit, apply to the selected site's state the evolution related to the measurement of $ \ket{1_a} $. Otherwise apply the evolution defined by the measurement of $ \ket{0_a} $ (see Eq.\eqref{eq:psi_evol_Diff0} and Eq.\eqref{eq:psi_evol_Diff1} or Eq.\eqref{eq:psi_evol_QJ})
		\item Once all the sites have been processed, Normalization of the resulting complete state
		\item Measurement and storage of the site Populations (using the \texttt{Projectors} list) and the Bloch State Vector components (using the \texttt{compute\_Bloch\_Sphere}) in the appropriate arrays.
		\item Repeat the algorithm for the next time step, until the total \textit{Dynamics Time} is covered.
		\item Once the Single Trajectory is completed, restart the Algorithm for a new Independent Trajectory.
		\item Finally , once all trajectories are computed and stored, compute the Average Value over different trajectories at every time step, for the Populations and \textit{Bloch State Vector} components.
	\end{enumerate} 
	
	\subsubsection{Parameters}
	\label{subsub:parameters}
	This section initializes all physical constants and simulation variables required for the dynamics.\\
	The parameters are organized into four logical categories:
	\begin{enumerate}
		\item System Parameters: 
		\begin{itemize}
			\item \texttt{N\_site}: Number of system sites ($N=2$).
			\item \texttt{E}: Site's energies initialized with random Gaussian disorder around the value $1.5$.
			\item \texttt{V\_array}: Hopping potential between sites, as defined Section \ref{subsub:Hamiltonians_U}.
		\end{itemize}
		
		\item Dynamics Parameters: 
		\begin{itemize}
			\item \texttt{dt\_list}: List of different time steps $\Delta t$ that defines the related \texttt{steps\_list} and \texttt{times\_list}.
			\item \texttt{N\_traj\_list}: List of Number of Trajectories.
			\item \texttt{tf}: Final simulation time.
		\end{itemize}
		
		\item Interaction Constants: 
		\begin{itemize}
			\item \texttt{g\_j}: List of Lindblad dephasing rate $\gamma_j$ for every \textit{j-th} site.
			\item \texttt{c\_CM\_list}: The collisional strength coefficients, recalculated for each $\Delta t$ as $c = \sqrt{\gamma / 4\Delta t}$.
		\end{itemize}
		
		\item Initial States and Operators: 
		\begin{itemize}
			\item \texttt{psi\_sys\_initial}: System initialized in the state $\ket{01}$.
			\item \texttt{rho\_anc}: Ancilla state, defined as Pure ($\ket{0}\bra{0}$) for QJ or Mixed ($\mathbb{I}/2$) for Diffusive limit.
			\item \texttt{L\_j} : List of Lindblad Jump Operator
			\item \texttt{projectors}: List of measurement operators ($P_{10}, P_{01}$) used to extract populations.
		\end{itemize}

		\item Dynamics Limit: \\
		the \texttt{INTERACTION\_LIMIT} parameter defines the \texttt{method} variable, allowing the simulation to be performed in either the \textit{Quantum Jump} or \textit{Diffusive Limit}.
	\end{enumerate}
	
	\subsection{Simulation Execution and Data Storage}
	The simulation iterates over $\Delta t$ and $N_{Traj}$ values, with nested loops, in order to analyze \textit{Convergence Properties}. To optimize storage, full trajectory histories are retained for only three random samples per configuration. All outcomes are organized in the \texttt{results} \textit{Dictionary}, structured as follows:
	
	\begin{figure}[htbp]
		\centering
		\begin{forest}
			for tree={
				grow=0,
				folder style,
				edge={draw=black!70, -Latex},
				s sep=1.5mm,
				l sep=10mm,
				anchor=west, child anchor=west, parent anchor=east,
				calign=child, calign primary child=1,
				font=\scriptsize,
				inner sep=2pt
			}
			[results, fill=blue!20, calign=center
			[dt\_list, fill=blue!10, calign=center
			[parameters, fill=gray!10, calign=center
			[dt]
			[N\_traj]
			[times]
			[steps]
			[c\_CM]
			]
			[pops\_trace, fill=purple!10]
			[pop\_trajectory\_isolated, fill=green!10]
			[pop\_lindblad, fill=cyan!10]
			[N\_traj\_list, fill=orange!10, calign=center
			[trajectory\_wf, fill=red!10, calign=center
			[pop\_traj\_samples]
			[average\_pop]
			[count]
			[avg\_count]
			[bloch, fill=yellow!10]
			]
			]
			]
			]
		\end{forest}
		\label{fig:results_structure}
	\end{figure}
	
	
	
\end{document}